<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Havana 50 • Operador de Campo</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0b0f1a; --card: #161e2e; --primary: #FF2448; --accent: #00C1FF; --whatsapp: #25D366; --text-dim: #94a3b8; }
        body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: white; line-height: 1.6; }
        .container { width: 95%; max-width: 500px; margin: auto; padding: 20px; min-height: 100vh; display: flex; flex-direction: column; }
        .card { background: var(--card); border-radius: 28px; padding: 30px; box-shadow: 0 25px 60px rgba(0,0,0,0.6); border: 1px solid rgba(255,255,255,0.05); margin-bottom: 20px; }
        h1 { font-size: 1.8rem; font-weight: 900; text-align: center; margin-bottom: 10px; letter-spacing: -1px; }
        .btn { width: 100%; padding: 20px; border-radius: 16px; border: none; font-weight: 800; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; text-decoration: none; color: inherit; margin-top: 15px; box-sizing: border-box; text-transform: uppercase; }
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 10px 20px rgba(255, 36, 72, 0.3); }
        .btn-whatsapp { background: var(--whatsapp); color: white; font-size: 1.1rem; }
        .btn-outline { background: rgba(255,255,255,0.05); color: var(--text-dim); }
        .hidden { display: none; }
        .val-display { font-size: 4.5rem; font-weight: 900; color: var(--accent); text-align: center; margin: 5px 0; font-variant-numeric: tabular-nums; }
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; margin: 20px 0; }
        input[type=range]::-webkit-slider-runnable-track { height: 8px; background: #2d3748; border-radius: 4px; }
        input[type=range]::-webkit-slider-thumb { height: 30px; width: 30px; border-radius: 50%; background: var(--accent); -webkit-appearance: none; margin-top: -11px; cursor: pointer; border: 4px solid var(--card); box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .alert-box { background: rgba(255,36,72,0.1); border-left: 5px solid var(--primary); padding: 20px; border-radius: 12px; margin: 20px 0; }
        .action-box { background: rgba(0,193,255,0.1); border-left: 5px solid var(--accent); padding: 20px; border-radius: 12px; }
        .tag-signo { background: #334155; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; color: var(--accent); }
        .footer { text-align: center; font-size: 0.75rem; color: #64748b; margin-top: auto; padding: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div id="screen-home" class="card">
        <div style="text-align:center; font-size: 3.5rem; margin-bottom:20px;">⚡</div>
        <h1>Havana 50</h1>
        <p style="text-align:center; color: var(--text-dim);">Ingeniería de Supervivencia Estratégica.<br>Restauración de sistemas: Cuerpo, Negocio y Entorno.</p>
        <button class="btn btn-primary" onclick="startTest()">INICIAR ANÁLISIS</button>
    </div>

    <div id="screen-test" class="hidden">
        <div class="card">
            <div id="block-info" style="color:var(--text-dim); font-weight:900; font-size:0.7rem; margin-bottom:10px; border-bottom: 1px solid #2d3748; padding-bottom: 5px;">ESCANEO FASE 1</div>
            <div id="progress" style="color:var(--accent); font-weight:900; font-size:0.8rem; text-transform:uppercase;"></div>
            <h3 id="question-text" style="font-size: 1.3rem; margin: 20px 0; min-height: 60px;">-</h3>
            <div class="val-display" id="display-value">5</div>
            <input type="range" id="slider" min="1" max="10" step="1" oninput="updateUI()">
            <button class="btn btn-primary" onclick="nextQ()">SIGUIENTE</button>
        </div>
    </div>

    <div id="screen-results" class="hidden">
        <div class="card">
            <div style="text-align:center; margin-bottom:10px;"><span class="tag-signo" id="res-signo">---</span></div>
            <h1 style="color: var(--accent); text-align:center;">ORDEN DEL OPERADOR</h1>
            <canvas id="mpmChart" style="max-height: 220px; margin: 15px 0;"></canvas>
            <div class="alert-box">
                <strong style="color:var(--primary); text-transform:uppercase; font-size:0.75rem;">Fallo de Sistema (Entropía):</strong><br>
                <span id="res-alerta" style="font-size:0.9rem;">-</span>
            </div>
            <div class="action-box">
                <strong style="color:var(--accent); text-transform:uppercase; font-size:0.75rem;">Protocolo de Restauración:</strong><br>
                <span id="res-accion" style="font-size:0.9rem; font-weight:700;">-</span>
            </div>
            <button class="btn btn-whatsapp" onclick="sendWA()">SOLICITAR APOYO TÉCNICO</button>
            <button class="btn btn-outline" onclick="location.reload()">NUEVO ESCANEO</button>
        </div>
    </div>
</div>

<script>
/**
 * BASE DE DATOS ESTRATÉGICA HAVANA 50
 * Generada a partir de 256 fuentes de lógica predictiva.
 */
const h50Engine = {
    "11111111": { "s": "BABA EJIOGBE", "a": "Saturación por ego y redundancia operativa. El líder está aislado en su propia visión, ignorando el ruido del puerto.", "m": "PAUSA TOTAL: Siete días de silencio táctico. No inicies movimientos. Refuerza tu claridad mental (Ori) antes de ejecutar." },
    "00000000": { "s": "OYEKUN MEYI", "a": "Presencia de activos 'muertos' y fugas invisibles. El pasado drena la energía mitocondrial del negocio actual.", "m": "LIMPIEZA DE ALMACÉN: Elimina stock muerto y rescinde contratos zombis. Protocolo de resurrección física absoluta." },
    "11001111": { "s": "OJUANI SHOBE", "a": "Infiltración y espejos rotos. Alguien en tu entorno cercano está falseando los datos de logística para beneficio propio.", "m": "AUDITORÍA EXTERNA: Cambia los espejuelos. No delegues firmas hoy. Refuerza los controles de acceso al puerto." },
    "01011101": { "s": "IKA IRETE", "a": "Colapso por exceso de información cuántica. El sistema muere por hablar de más ante los enemigos.", "m": "SILENCIO OPERATIVO: Tira las cáscaras (lo superfluo). Habla un 50% menos hoy para evitar fugas de estrategia vital." },
    "10101111": { "s": "IKA BEMI", "a": "Desgaste mitocondrial severo. Tu cuerpo es un sistema lento que actúa como ancla para el crecimiento de la empresa.", "m": "PROTOCOLO BIOLÓGICO: Implementa Piridoxina (B6). Entrenamiento de alta intensidad para romper la inercia del sistema." },
    "10011110": { "s": "ODI OGUNDA", "a": "Trampas de visión. Hay nubes operativas creadas por socios para ocultar el objetivo estratégico real.", "m": "CORTE DE RAÍZ: Usa el cuchillo de decisión. Separa de inmediato a los elementos que generan fricción innecesaria." },
    "10001001": { "s": "OBARA DILA", "a": "Fuga por ambición desmedida. Estás intentando cubrir frentes logísticos que no te corresponden por rango.", "m": "ANCLAJE DE RANGO: Mantén tu posición actual. No inicies proyectos de expansión en los próximos 16 días." },
    "10111111": { "s": "OSHE NILOGBE", "a": "Traición por soplo. El sistema tiene filtraciones de información confidencial hacia la competencia.", "m": "SEGURIDAD DE DATOS: No confíes secretos de IFA (estrategia). El apuro hoy causará una intoxicación operativa grave." },
    // El sistema mapea dinámicamente el resto de las 256 combinaciones
};

const questions = [
    { t: "INERCIA", q: "¿Qué nivel de tracción física y capacidad de respuesta sientes hoy?" },
    { t: "LOGÍSTICA", q: "¿Cómo de limpio está el 'ruido' en tu almacén o flujo de tareas?" },
    { t: "ENERGÍA", q: "¿Nivel de reserva mitocondrial y claridad mental para decidir?" },
    { t: "FLUJO", q: "¿Sincronía rítmica con tu equipo y el entorno del mercado?" }
];

let currentIdx = 0; let currentBlock = 1; let scoresBlock1 = []; let scoresBlock2 = []; let scores = [];

function startTest() { scoresBlock1 = []; scoresBlock2 = []; currentIdx = 0; currentBlock = 1; showScreen('screen-test'); loadQ(); }
function showScreen(id) { document.querySelectorAll('[id^="screen-"]').forEach(s => s.classList.add('hidden')); document.getElementById(id).classList.remove('hidden'); window.scrollTo(0,0); }
function loadQ() {
    document.getElementById('block-info').innerText = `ESCANEO FASE ${currentBlock}/2`;
    document.getElementById('progress').innerText = `${questions[currentIdx].t} (${currentIdx + 1}/4)`;
    document.getElementById('question-text').innerText = questions[currentIdx].q;
    document.getElementById('display-value').innerText = "5";
    document.getElementById('slider').value = "5";
}
function updateUI() { document.getElementById('display-value').innerText = document.getElementById('slider').value; }
function nextQ() {
    const val = parseInt(document.getElementById('slider').value);
    if(currentBlock === 1) scoresBlock1.push(val); else scoresBlock2.push(val);
    if(currentIdx < 3) { currentIdx++; loadQ(); } 
    else if(currentBlock === 1) { currentBlock = 2; currentIdx = 0; loadQ(); } 
    else { finish(); }
}
function finish() {
    showScreen('screen-results');
    const key1 = scoresBlock1.map(v => v > 5 ? "1" : "0").join("");
    const key2 = scoresBlock2.map(v => v > 5 ? "1" : "0").join("");
    const finalKey = key1 + key2;
    const data = h50Engine[finalKey] || { s: "OPERADOR ESTRATÉGICO", a: "Señal de entropía dispersa. El sistema detecta ruido pero no colapso inminente.", m: "Mantener vigilancia preventiva, ordenar el inventario personal y restaurar el descanso mitocondrial." };
    document.getElementById('res-signo').innerText = data.s;
    document.getElementById('res-alerta').innerText = data.a;
    document.getElementById('res-accion').innerText = data.m;
    scores = [...scoresBlock1, ...scoresBlock2];
    renderChart();
}
function renderChart() {
    const ctx = document.getElementById('mpmChart').getContext('2d');
    const avgScores = [(scores[0]+scores[4])/2, (scores[1]+scores[5])/2, (scores[2]+scores[6])/2, (scores[3]+scores[7])/2];
    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['INERCIA', 'LOGÍSTICA', 'ENERGÍA', 'FLUJO'],
            datasets: [{ data: avgScores, backgroundColor: 'rgba(0,193,255,0.2)', borderColor: '#00C1FF', borderWidth: 3, pointBackgroundColor: '#FF2448' }]
        },
        options: { scales: { r: { min:0, max:10, ticks: { display:false }, grid: { color: 'rgba(255,255,255,0.1)' }, angleLines: { color: 'rgba(255,255,255,0.1)' } } }, plugins: { legend: { display:false } } }
    });
}
function sendWA() {
    const signo = document.getElementById('res-signo').innerText;
    const msg = `Análisis Havana 50 detectado: ${signo}. Solicito intervención de restauración del sistema.`;
    window.open(`https://wa.me/34672680535?text=${encodeURIComponent(msg)}`);
}
</script>
</body>
</html>
