<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MPM ‚Ä¢ Diagn√≥stico Estrat√©gico</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --primary: #FF2448; --accent: #00C1FF; --whatsapp: #25D366; --fuego: #ff5e37; --agua: #37b3ff; --tierra: #7ad65d; --aire: #dfe6e9; }
        body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: white; line-height: 1.6; }
        .container { width: 95%; max-width: 500px; margin: auto; padding: 20px; min-height: 100vh; display: flex; flex-direction: column; }
        .card { background: var(--card); border-radius: 24px; padding: 25px; box-shadow: 0 20px 50px rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.05); margin-bottom: 20px; flex-grow: 1; }
        h1 { font-size: 1.7rem; font-weight: 900; text-align: center; margin-bottom: 5px; }
        .btn { width: 100%; padding: 18px; border-radius: 14px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; text-decoration: none; color: inherit; margin-top: 10px; box-sizing: border-box; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-whatsapp { background: var(--whatsapp); color: white; font-size: 1.1rem; }
        .btn-outline { background: rgba(255,255,255,0.05); color: #94a3b8; text-align: center; }
        .hidden { display: none; }
        .tag { padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: bold; text-transform: uppercase; }
        .fuego { background: var(--fuego); color: white; } .agua { background: var(--agua); color: white; } .tierra { background: var(--tierra); color: white; } .aire { background: var(--aire); color: black; }
        .binary-id { font-family: monospace; opacity: 0.4; font-size: 0.8rem; margin-left: 5px; }
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-runnable-track { height: 10px; background: #334155; border-radius: 5px; }
        input[type=range]::-webkit-slider-thumb { height: 26px; width: 26px; border-radius: 50%; background: var(--accent); -webkit-appearance: none; margin-top: -8px; }
        .val-display { font-size: 3.5rem; font-weight: 900; color: var(--accent); text-align: center; margin: 10px 0; }
        .logo-img { width: 90px; height: 90px; border-radius: 50%; margin: 0 auto 15px; display: block; border: 2px solid var(--accent); }
        .footer-info { text-align: center; padding: 20px; font-size: 0.75rem; color: #64748b; margin-top: auto; }
        .footer-info a { color: var(--accent); text-decoration: none; font-weight: bold; }
        .legal-box { font-size: 0.65rem; color: #475569; text-align: justify; margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 12px; line-height: 1.3; }
    </style>
</head>
<body>

<div class="container">
    <div id="screen-home" class="card">
        <img src="logo.png" alt="MPM" class="logo-img" onerror="this.style.display='none'">
        <h1>Preemptive Movement</h1>
        <p style="text-align:center; color: #94a3b8;">Manual Preemptive Movement. Sistema de diagn√≥stico estrat√©gico para la anticipaci√≥n de patrones.</p>
        <button class="btn btn-primary" onclick="showScreen('screen-menu')">INICIAR EVALUACI√ìN</button>
    </div>

    <div id="screen-menu" class="hidden">
        <div class="card">
            <h2 style="margin-top:0">Selecciona M√≥dulo</h2>
            <div id="menu-list" style="display: grid; gap: 8px;"></div>
        </div>
    </div>

    <div id="screen-test" class="hidden">
        <div class="card">
            <div id="test-progress" style="color:var(--accent); font-weight:bold; margin-bottom:10px;"></div>
            <h3 id="question-text" style="min-height: 50px;">-</h3>
            <div class="val-display" id="display-value">5</div>
            <input type="range" id="main-slider" min="1" max="10" step="1" oninput="updateUIValue()">
            <div style="display:flex; gap:10px; margin-top:30px;">
                <button class="btn btn-outline" style="flex:1" onclick="prevQ()">Atr√°s</button>
                <button class="btn btn-primary" style="flex:2" onclick="nextQ()">Siguiente</button>
            </div>
        </div>
    </div>

    <div id="screen-results" class="hidden">
        <div class="card">
            <h1 style="color: var(--accent);">Informe de Patrones</h1>
            <canvas id="mpmChart" style="margin: 20px 0;"></canvas>
            
            <div id="analysis-box" style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 15px; border-left: 4px solid var(--primary);">
                <div id="logic-text" style="font-size: 0.9rem;"></div>
            </div>

            <div style="margin-top: 25px;">
                <p style="text-align:center; font-weight:bold; color: var(--accent); margin-bottom:15px;">¬øNecesitas el protocolo de correcci√≥n?</p>
                <input type="text" id="userName" placeholder="Tu nombre" style="width:100%; padding:15px; border-radius:10px; border:none; margin-bottom:10px; background: #0f172a; color:white; box-sizing: border-box;">
                <button class="btn btn-whatsapp" onclick="sendWhatsApp()">SOLICITAR CONSULTOR√çA</button>
            </div>
            
            <button class="btn btn-outline" onclick="resetApp()">NUEVO AN√ÅLISIS</button>

            <div class="legal-box">
                <strong>AVISO LEGAL:</strong> Este diagn√≥stico es una herramienta de orientaci√≥n basada en el m√©todo MPM. Los resultados son interpretaciones de patrones y no constituyen consejo m√©dico, psicol√≥gico o financiero vinculante. El uso de esta aplicaci√≥n implica la aceptaci√≥n de que el consultor no se hace responsable de las decisiones tomadas tras la lectura. Para un an√°lisis profesional, solicite una sesi√≥n privada.
            </div>
        </div>
    </div>

    <div class="footer-info">
        <p>Preemptive Movement ¬© 2026 | Consultor√≠a Estrat√©gica</p>
        <p>Contacto: <a href="mailto:preemptivemovement@gmail.com">preemptivemovement@gmail.com</a></p>
        <p>Explora el m√©todo en: <a href="https://preemptivemovement.blogspot.com/" target="_blank">Nuestro Blog Oficial</a></p>
    </div>
</div>

<script>
const testsData = {
    colores: { n:"üé® Colores", q:["Rojo","Azul","Verde","Amarillo","Negro","Blanco","Morado","Naranja","Rosa","Gris","Turquesa","Marr√≥n","Dorado","Plateado","Beige","Fucsia"]},
    ciudades: { n:"üåÜ Ciudades", q:["Tokio","Par√≠s","Nueva York","Roma","Londres","S√≠dney","√Åmsterdam","Se√∫l","Barcelona","Los √Ångeles","Dub√°i","Berl√≠n","Buenos Aires","Toronto","El Cairo","Madrid"]},
    autos: { n:"üöó Autom√≥viles", q:["Ferrari","Toyota","Mercedes","Audi","Tesla","Ford","BMW","Chevrolet","Lamborghini","Honda","Porsche","Hyundai","Range Rover","Volkswagen","Peugeot","Citro√´n"]},
    alimentos: { n:"üçΩ Alimentos", q:["Chocolate","Manzana","Caf√©","Pan","Carne","Pasta","Arroz","Queso","Pollo","Miel","Nueces","Salm√≥n","Fresas","Aguacate","Huevos","Yogur"]},
    profesiones: { n:"üíº Profesiones", q:["M√©dico","Artista","Ingeniero","Abogado","Maestro","Programador","Empresario","Psic√≥logo","Chef","Polic√≠a","Arquitecto","Deportista","Cient√≠fico","Actor","Piloto","Escritor"]},
    animales: { n:"ü¶Å Animales", q:["Le√≥n","Lobo","√Åguila","Delf√≠n","Tigre","Serpiente","Perro","Gato","Caballo","B√∫ho","Tibur√≥n","Oso","Cuervo","Conejo","Toro","Halc√≥n"]},
    estaciones: { n:"üçÅ Estaciones", q:["Primavera","Verano","Oto√±o","Invierno","Amanecer","Atardecer","Mediod√≠a","Medianoche","Clima tropical","Clima √°rtico","Clima templado","Clima des√©rtico","Ambiente h√∫medo","Ambiente seco","Zona monta√±osa","Zona costera"]},
    instrumentos: { n:"üéµ Instrumentos", q:["Piano","Guitarra","Viol√≠n","Flauta","Bater√≠a","Saxof√≥n","Arpa","Trompeta","Bajo","Acorde√≥n","Ukelele","Timbal","DJ Mixer","Voz humana","√ìrgano","Cello"]},
    paises: { n:"üåç Pa√≠ses", q:["Jap√≥n","Estados Unidos","Francia","Espa√±a","Alemania","Italia","M√©xico","Brasil","Argentina","Canad√°","Australia","Egipto","India","China","Rusia","Grecia"]},
    metales: { n:"üî© Metales", q:["Oro","Plata","Bronce","Cobre","Hierro","Plomo","Titanio","Mercurio","Acero","Lat√≥n","Platino","Wolframio","N√≠quel","Aluminio","Cobalto","Iridio"]},
    paisajes: { n:"üèû Paisajes", q:["Mar","Bosque","Monta√±a","Desierto","Cascada","Pradera","Jungla","Cueva","Glaciar","Ca√±√≥n","Volc√°n","Llanura","Isla","Tundra","Sabana","Arrecife"]},
    arquitectura: { n:"üèõ Arquitectura", q:["Minimalista","Barroco","G√≥tico","Rom√°nico","Brutalista","Art Deco","Cl√°sico","Futurista","Industrial","Neocl√°sico","Org√°nico","Colonial","High-Tech","Renacentista","Moderno","Posmoderno"]},
    sabores: { n:"üçØ Sabores", q:["Dulce","√Åcido","Amargo","Salado","Umami","Picante","Agridulce","Herbal","Tostado","Fresco","Cremoso","Fermentado","Marino","Ahumado","Frutal","Especiado"]},
    tecnologias: { n:"üì≤ Tecnolog√≠as", q:["IA","Rob√≥tica","Web3","Cripto","Medicina","Bioingenier√≠a","Big Data","Nano","VR","Sat√©lites","EVs","IoT","Cloud","Fusi√≥n","Drones","Quantum"]},
    epocas: { n:"‚åõ √âpocas", q:["Grecia","Roma","Edad Media","Renacimiento","Ilustraci√≥n","Rev Industrial","A√±os 20","A√±os 50","A√±os 80","Actualidad","Futuro Cercano","Futuro Lejano","Barroco","Romanticismo","Modernismo","Transhumanismo"]},
    arquetipos: { n:"üî± Arquetipos", q:["Drag√≥n","F√©nix","Unicornio","Kraken","Pegaso","Minotauro","Sirena","Grifo","Quimera","Anubis","Thor","Medusa","Zeus","Hades","Ra","Od√≠n"]}
};

const tablaMPM = {
    "1111":[1,"fuego","ALTA ENERG√çA"],"0000":[2,"fuego","CONTENCI√ìN"],"0110":[3,"agua","EXPANSI√ìN"],"1001":[4,"agua","INVOLUCI√ìN"],"1000":[5,"aire","ENFOQUE"],"0001":[6,"tierra","INESTABILIDAD"],"1110":[7,"tierra","SOLIDEZ"],"0111":[8,"aire","DISPERSI√ìN"],"1100":[9,"fuego","IMPULSO"],"0011":[10,"fuego","CAOS"],"0100":[11,"agua","SENSIBILIDAD"],"0010":[12,"tierra","DISCIPLINA"],"1101":[13,"tierra","DESGASTE"],"1011":[14,"agua","TURBULENCIA"],"1010":[15,"aire","CREATIVIDAD"],"0101":[16,"aire","ATURDIMIENTO"]
};

let currentModule = ''; let currentIdx = 0; let scores = []; let lastResult = {}; let myChart = null;

function showScreen(id) {
    document.querySelectorAll('[id^="screen-"]').forEach(s => s.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
    window.scrollTo(0,0);
}

function init() {
    const list = document.getElementById('menu-list');
    Object.keys(testsData).forEach(key => {
        const b = document.createElement('button');
        b.className = 'btn btn-outline';
        b.innerText = testsData[key].n;
        b.onclick = () => { currentModule = key; currentIdx = 0; scores = Array(16).fill(5); loadQuestion(); showScreen('screen-test'); };
        list.appendChild(b);
    });
}

function loadQuestion() {
    document.getElementById('test-progress').innerText = `${testsData[currentModule].n} | ${currentIdx+1}/16`;
    document.getElementById('question-text').innerText = testsData[currentModule].q[currentIdx];
    document.getElementById('display-value').innerText = scores[currentIdx];
    document.getElementById('main-slider').value = scores[currentIdx];
}

function updateUIValue() {
    scores[currentIdx] = parseInt(document.getElementById('main-slider').value);
    document.getElementById('display-value').innerText = scores[currentIdx];
}

function nextQ() {
    if(currentIdx < 15) { currentIdx++; loadQuestion(); }
    else { generateFinalAnalysis(); }
}

function prevQ() { if(currentIdx > 0) { currentIdx--; loadQuestion(); } }

function generateFinalAnalysis() {
    showScreen('screen-results');
    const getB = (s) => {
        const chunk = scores.slice(s, s+4);
        // CAMBIO DE L√ìGICA AQU√ç: 1 si es > 5 (6-10), 0 si es <= 5 (1-5)
        const bits = chunk.map(v => v > 5 ? "1" : "0").join("");
        const d = tablaMPM[bits] || [9, "aire", "NEUTRO"];
        return { id:d[0], elem:d[1], msg:d[2], bit: bits.charAt(0) };
    };

    const S = getB(0); const M = getB(4); const T = getB(8); const R = getB(12);
    lastResult = { S, M, T, R };

    let diag = "";
    const combo = S.elem + R.elem;
    
    switch(combo) {
        case 'fuegofuego': diag = "Tu motor interno est√° operando en redundancia. Proyectas energ√≠a pero el resultado replica el inicio sin una evoluci√≥n t√°ctica real."; break;
        case 'fuegoagua': diag = "Fuga energ√©tica por polaridad. Tu impulso inicial se 'evapora' al contactar con el resultado. Se requiere ajuste en la fase de Transformaci√≥n."; break;
        case 'airetierra': diag = "Base inestable. Est√°s intentando materializar sobre ideas demasiado vol√°tiles. Falta anclaje estructural en tu movimiento."; break;
        case 'tierraaire': diag = "Exceso de rigidez estructural. El sistema es demasiado pesado para el dinamismo que buscas proyectar al final."; break;
        case 'aguaaire': diag = "Alta sensibilidad con riesgo de dispersi√≥n. Tu intuici√≥n es correcta, pero el resultado carece de un marco de ejecuci√≥n claro."; break;
        case 'tierrafuego': diag = "Alta capacidad de materializaci√≥n. Est√°s logrando transformar la solidez en movimiento din√°mico y resultados activos."; break;
        default: diag = "Se detecta una asimetr√≠a en la transici√≥n. El flujo entre tu Situaci√≥n actual y el Resultado muestra un patr√≥n de resistencia moderada.";
    }

    document.getElementById('logic-text').innerHTML = `
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:15px;">
            <div><strong>S:</strong> <span class="tag ${S.elem}">${S.elem}</span> <span class="binary-id">${S.bit}</span></div>
            <div><strong>M:</strong> <span class="tag ${M.elem}">${M.elem}</span> <span class="binary-id">${M.bit}</span></div>
            <div><strong>T:</strong> <span class="tag ${T.elem}">${T.elem}</span> <span class="binary-id">${T.bit}</span></div>
            <div><strong>R:</strong> <span class="tag ${R.elem}">${R.elem}</span> <span class="binary-id">${R.bit}</span></div>
        </div>
        <p style="border-top: 1px solid rgba(255,255,255,0.1); padding-top:10px; font-style: italic;">"${diag}"</p>
    `;
    renderChart(scores);
}

function renderChart(sc) {
    const ctx = document.getElementById('mpmChart').getContext('2d');
    const data = [
        sc.slice(0,4).reduce((a,b)=>a+b)/4, sc.slice(4,8).reduce((a,b)=>a+b)/4,
        sc.slice(8,12).reduce((a,b)=>a+b)/4, sc.slice(12,16).reduce((a,b)=>a+b)/4
    ];
    if(myChart) myChart.destroy();
    myChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['SITUACI√ìN', 'MOVIMIENTO', 'TRANSFORMACI√ìN', 'RESULTADO'],
            datasets: [{ data, backgroundColor: 'rgba(0,193,255,0.2)', borderColor: '#00C1FF', pointBackgroundColor: '#FF2448', borderWidth: 3 }]
        },
        options: { scales: { r: { min:0, max:10, ticks: { display:false }, grid: { color: 'rgba(255,255,255,0.1)' } } }, plugins: { legend: { display:false } } }
    });
}

function sendWhatsApp() {
    const name = document.getElementById('userName').value || "Interesado";
    const msg = `Hola, soy ${name}. Diagn√≥stico MPM finalizado. Patr√≥n: S:${lastResult.S.id}, M:${lastResult.M.id}, T:${lastResult.T.id}, R:${lastResult.R.id}. Solicito consultor√≠a profesional.`;
    window.open(`https://wa.me/34672680535?text=${encodeURIComponent(msg)}`);
}

function resetApp() {
    if(myChart) myChart.destroy();
    myChart = null;
    showScreen('screen-menu');
}

init();
</script>
</body>
</html>
